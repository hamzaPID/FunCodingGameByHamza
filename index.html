<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FunLogicBlocksByHamza – Build the Logic</title>
  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f5;
      color: #111;
    }
    #container {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    header {
      padding: 10px 16px;
      background: #1e3a8a;
      color: #ffffff;
    }
    header h1 {
      margin: 0;
      font-size: 20px;
    }
    header p {
      margin: 2px 0 0;
      font-size: 12px;
      opacity: 0.9;
    }

    #main {
      flex: 1;
      display: flex;
      padding: 10px;
      gap: 10px;
      box-sizing: border-box;
    }

    .panel {
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.08);
      padding: 10px;
      box-sizing: border-box;
      font-size: 13px;
      overflow: auto;
    }

    #leftPanel {
      width: 28%;
      min-width: 220px;
    }
    #middlePanel {
      width: 36%;
      min-width: 260px;
    }
    #rightPanel {
      flex: 1;
    }

    h2 {
      margin: 0 0 6px;
      font-size: 15px;
      color: #1f2933;
    }

    select {
      padding: 4px 6px;
      font-size: 12px;
      border-radius: 4px;
      border: 1px solid #ccc;
      margin-bottom: 6px;
    }

    .puzzle-desc {
      background: #f3f4ff;
      border-radius: 6px;
      padding: 6px 8px;
      font-size: 12px;
      margin-bottom: 8px;
    }

    .highlight {
      font-weight: 600;
      color: #1e3a8a;
    }

    .block-list {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .code-block {
      background: #f1f5f9;
      border-radius: 6px;
      padding: 4px 6px;
      font-family: "JetBrains Mono", "Consolas", monospace;
      font-size: 11px;
      border: 1px solid #cbd5e1;
      cursor: pointer;
      white-space: nowrap;
      user-select: none;
      transition: background 0.15s, transform 0.1s;
    }
    .code-block:hover {
      background: #e0f2fe;
      transform: translateY(-1px);
    }
    .code-block.disabled {
      opacity: 0.45;
      cursor: default;
      transform: none;
    }

    #yourLogicArea {
      min-height: 120px;
      border-radius: 6px;
      border: 1px dashed #cbd5e1;
      padding: 6px;
      background: #f9fafb;
    }

    .logic-block {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: #e5f3ff;
      border-radius: 6px;
      padding: 3px 6px;
      margin: 3px;
      font-family: "JetBrains Mono", "Consolas", monospace;
      font-size: 11px;
      border: 1px solid #bfdbfe;
    }

    .logic-index {
      font-size: 10px;
      color: #555;
    }

    #buttonsRow {
      margin-top: 6px;
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    button {
      padding: 5px 8px;
      font-size: 12px;
      border-radius: 6px;
      border: 1px solid #888;
      background: #f8fafc;
      cursor: pointer;
    }
    button.primary {
      background: #2563eb;
      color: #fff;
      border-color: #1d4ed8;
    }
    button.primary:hover {
      background: #1d4ed8;
    }
    button:hover {
      background: #e2e8f0;
    }

    #feedbackBox {
      margin-top: 6px;
      font-size: 12px;
      padding: 6px 8px;
      border-radius: 6px;
      background: #f1f5f9;
      border: 1px solid #e2e8f0;
    }

    #scoreLine {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .good {
      color: #15803d;
    }
    .bad {
      color: #b91c1c;
    }

    #exampleBox {
      margin-top: 6px;
      font-size: 11px;
      padding: 5px 7px;
      border-radius: 6px;
      background: #fefce8;
      border: 1px solid #facc15;
    }

    @media (max-width: 900px) {
      #main {
        flex-direction: column;
      }
      #leftPanel, #middlePanel, #rightPanel {
        width: 100%;
      }
    }
  </style>
</head>
<body>
<div id="container">
  <header>
    <h1>FunLogicBlocksByHamza – Build the Logic</h1>
    <p>Pick pseudo-code blocks to form a correct solution for each puzzle. Order matters. Then check your logic and see your score.</p>
  </header>

  <div id="main">
    <!-- LEFT: Puzzle selection + description -->
    <div class="panel" id="leftPanel">
      <h2>Puzzle</h2>
      <label for="puzzleSelect" style="font-size:12px;">Choose a challenge:</label><br>
      <select id="puzzleSelect">
        <option value="loop_1to5">Print numbers 1 to 5</option>
        <option value="sum_1to5">Sum of numbers 1 to 5</option>
        <option value="max_two">Maximum of two numbers</option>
        <option value="even_odd">Check even / odd</option>
        <option value="countdown_5to1">Countdown from 5 to 1</option>
        <option value="factorial_n">Factorial of n</option>
        <option value="pos_neg_zero">Positive / Negative / Zero</option>
        <option value="avg_three">Average of three numbers</option>
        <option value="swap_two">Swap two numbers</option>
        <option value="linear_search">Linear search in a list</option>
      </select>

      <div id="puzzleDesc" class="puzzle-desc"></div>

      <div style="font-size:11px;margin-top:4px;">
        <span class="highlight">Goal:</span> Arrange the pseudo-code blocks in the correct order to solve the puzzle.<br>
        You can:
        <ul style="margin:4px 0 0 18px;padding:0;font-size:11px;">
          <li>Click a block to add it to <strong>Your Logic</strong>.</li>
          <li>Use <strong>Undo</strong> or <strong>Clear</strong> if you change your mind.</li>
          <li>Press <strong>Check Logic</strong> to get instant feedback.</li>
        </ul>
        Assume variables named in the puzzle (like <code>n</code>, <code>a</code>, <code>b</code>) are already declared.
      </div>
    </div>

    <!-- MIDDLE: Available blocks -->
    <div class="panel" id="middlePanel">
      <h2>Available Blocks</h2>
      <div style="font-size:11px;margin-bottom:4px;">
        Each block is written in simple pseudo-code. Click blocks to add them to your logic in order.<br>
        <strong>Note:</strong> <code>WHILE ... DO</code> and <code>FOR EACH ... DO</code> are loop blocks,
        and must be closed with matching <code>END WHILE</code> / <code>END FOR</code>.
      </div>
      <div id="availableBlocks" class="block-list"></div>
    </div>

    <!-- RIGHT: Your logic + score -->
    <div class="panel" id="rightPanel">
      <h2>Your Logic</h2>
      <div id="yourLogicArea">
        <span style="font-size:11px;color:#64748b;">
          Your chosen blocks will appear here in order:<br>
          <em>Step 1, Step 2, Step 3, ...</em>
        </span>
      </div>

      <div id="buttonsRow">
        <button id="undoBtn">Undo last</button>
        <button id="clearBtn">Clear all</button>
        <button id="checkBtn" class="primary">Check Logic</button>
      </div>

      <div id="feedbackBox">
        <div id="scoreLine">Score: —</div>
        <div id="feedbackText">Build a program above and press "Check Logic" to see how close you are.</div>
      </div>

      <div id="exampleBox">
        Designed and Developed by Hamza Sohail - DE 40 MTS
      </div>
    </div>
  </div>
</div>

<script>
  // Puzzle definitions in pseudo-code
  const puzzles = {
    // 1) Print 1 to 5
    "loop_1to5": {
      title: "Print numbers 1 to 5",
      description: `
        Write pseudo-code to print the numbers from 1 to 5 in order.<br>
        Use a counter <code>i</code>, a loop, and a PRINT statement.
      `,
      blocks: [
        { id: "init_i1", text: "SET i ← 1" },
        { id: "while_i_le_5", text: "WHILE i ≤ 5 DO" },
        { id: "print_i", text: "PRINT i" },
        { id: "inc_i", text: "SET i ← i + 1" },
        { id: "end_while", text: "END WHILE" },
        // distractors
        { id: "init_i0", text: "SET i ← 0" },
        { id: "while_i_lt_5", text: "WHILE i < 5 DO" },
        { id: "dec_i", text: "SET i ← i - 1" }
      ],
      solution: ["init_i1", "while_i_le_5", "print_i", "inc_i", "end_while"]
    },

    // 2) Sum 1 to 5
    "sum_1to5": {
      title: "Sum of numbers 1 to 5",
      description: `
        Write pseudo-code to calculate the sum 1 + 2 + 3 + 4 + 5.<br>
        Use variables <code>total</code> and <code>i</code>.
        At the end, PRINT the total.
      `,
      blocks: [
        { id: "set_total0", text: "SET total ← 0" },
        { id: "set_i1", text: "SET i ← 1" },
        { id: "while_i_le_5", text: "WHILE i ≤ 5 DO" },
        { id: "add_to_total", text: "SET total ← total + i" },
        { id: "inc_i", text: "SET i ← i + 1" },
        { id: "end_while", text: "END WHILE" },
        { id: "print_total", text: "PRINT total" },
        // distractors
        { id: "set_total1", text: "SET total ← 1" },
        { id: "print_i", text: "PRINT i" }
      ],
      solution: [
        "set_total0", "set_i1", "while_i_le_5",
        "add_to_total", "inc_i", "end_while", "print_total"
      ]
    },

    // 3) Max of two numbers
    "max_two": {
      title: "Maximum of two numbers",
      description: `
        You have two numbers <code>a</code> and <code>b</code>, and a variable <code>max</code>.<br>
        Store the larger of <code>a</code> and <code>b</code> in <code>max</code>.
      `,
      blocks: [
        { id: "if_ageb", text: "IF a ≥ b THEN" },
        { id: "set_max_a", text: "    SET max ← a" },
        { id: "else", text: "ELSE" },
        { id: "set_max_b", text: "    SET max ← b" },
        { id: "end_if", text: "END IF" },
        // distractors
        { id: "if_altb", text: "IF a < b THEN" },
        { id: "set_max0", text: "SET max ← 0" }
      ],
      solution: ["if_ageb", "set_max_a", "else", "set_max_b", "end_if"]
    },

    // 4) Even / Odd
    "even_odd": {
      title: "Check even / odd",
      description: `
        You have an integer <code>n</code>.<br>
        Print <code>\"Even\"</code> if the number is even, otherwise print <code>\"Odd\"</code>.<br>
        Use the condition <code>n MOD 2 = 0</code>.
      `,
      blocks: [
        { id: "if_even", text: "IF n MOD 2 = 0 THEN" },
        { id: "print_even", text: "    PRINT \"Even\"" },
        { id: "else", text: "ELSE" },
        { id: "print_odd", text: "    PRINT \"Odd\"" },
        { id: "end_if", text: "END IF" },
        // distractors
        { id: "if_odd", text: "IF n MOD 2 ≠ 0 THEN" },
        { id: "print_n", text: "PRINT n" }
      ],
      solution: ["if_even", "print_even", "else", "print_odd", "end_if"]
    },

    // 5) Countdown 5 to 1
    "countdown_5to1": {
      title: "Countdown from 5 to 1",
      description: `
        Write pseudo-code to print 5, 4, 3, 2, 1 in this order.<br>
        Use a counter <code>i</code> that starts at 5 and goes down to 1.
      `,
      blocks: [
        { id: "set_i5", text: "SET i ← 5" },
        { id: "while_i_ge_1", text: "WHILE i ≥ 1 DO" },
        { id: "print_i", text: "PRINT i" },
        { id: "dec_i", text: "SET i ← i - 1" },
        { id: "end_while", text: "END WHILE" },
        // distractors
        { id: "set_i1", text: "SET i ← 1" },
        { id: "inc_i", text: "SET i ← i + 1" },
        { id: "while_i_le_5", text: "WHILE i ≤ 5 DO" }
      ],
      solution: ["set_i5", "while_i_ge_1", "print_i", "dec_i", "end_while"]
    },

    // 6) Factorial of n
    "factorial_n": {
      title: "Factorial of n",
      description: `
        You have an integer <code>n</code>. Compute <code>n!</code> (n factorial).<br>
        Use <code>result</code> to store the answer and a counter <code>i</code> from 1 to n.
      `,
      blocks: [
        { id: "set_result1", text: "SET result ← 1" },
        { id: "set_i1", text: "SET i ← 1" },
        { id: "while_i_le_n", text: "WHILE i ≤ n DO" },
        { id: "mul_result", text: "SET result ← result × i" },
        { id: "inc_i", text: "SET i ← i + 1" },
        { id: "end_while", text: "END WHILE" },
        { id: "print_result", text: "PRINT result" },
        // distractors
        { id: "set_result0", text: "SET result ← 0" },
        { id: "dec_i", text: "SET i ← i - 1" }
      ],
      solution: [
        "set_result1", "set_i1", "while_i_le_n",
        "mul_result", "inc_i", "end_while", "print_result"
      ]
    },

    // 7) Positive / Negative / Zero
    "pos_neg_zero": {
      title: "Positive / Negative / Zero",
      description: `
        You have an integer <code>n</code>.<br>
        Print whether it is <code>\"Positive\"</code>, <code>\"Negative\"</code>, or <code>\"Zero\"</code>.
      `,
      blocks: [
        { id: "if_n_gt_0", text: "IF n > 0 THEN" },
        { id: "print_pos", text: "    PRINT \"Positive\"" },
        { id: "elseif_n_lt_0", text: "ELSE IF n < 0 THEN" },
        { id: "print_neg", text: "    PRINT \"Negative\"" },
        { id: "else_zero", text: "ELSE" },
        { id: "print_zero", text: "    PRINT \"Zero\"" },
        { id: "end_if", text: "END IF" },
        // distractors
        { id: "if_n_ge_0", text: "IF n ≥ 0 THEN" }
      ],
      solution: [
        "if_n_gt_0", "print_pos",
        "elseif_n_lt_0", "print_neg",
        "else_zero", "print_zero", "end_if"
      ]
    },

    // 8) Average of three numbers
    "avg_three": {
      title: "Average of three numbers",
      description: `
        You have numbers <code>a</code>, <code>b</code>, and <code>c</code>.<br>
        Compute their average in <code>avg</code> and PRINT it.
      `,
      blocks: [
        { id: "set_sum", text: "SET sum ← a + b + c" },
        { id: "set_avg", text: "SET avg ← sum / 3" },
        { id: "print_avg", text: "PRINT avg" },
        // distractors
        { id: "set_avg_wrong", text: "SET avg ← a + b + c" },
        { id: "print_sum", text: "PRINT sum" }
      ],
      solution: ["set_sum", "set_avg", "print_avg"]
    },

    // 9) Swap two numbers
    "swap_two": {
      title: "Swap two numbers",
      description: `
        You have two variables <code>a</code> and <code>b</code>.<br>
        Swap their values using a temporary variable <code>temp</code>.
      `,
      blocks: [
        { id: "set_temp_a", text: "SET temp ← a" },
        { id: "set_a_b", text: "SET a ← b" },
        { id: "set_b_temp", text: "SET b ← temp" },
        // distractors
        { id: "set_temp_b", text: "SET temp ← b" },
        { id: "set_b_a", text: "SET b ← a" }
      ],
      solution: ["set_temp_a", "set_a_b", "set_b_temp"]
    },

    // 10) Linear search in a list
    "linear_search": {
      title: "Linear search in a list",
      description: `
        You have a list of numbers and a value <code>key</code>.<br>
        Use linear search to check if <code>key</code> is present.<br>
        At the end, PRINT "Found" or "Not found".
      `,
      blocks: [
        { id: "set_found_false", text: "SET found ← FALSE" },
        { id: "for_each_x", text: "FOR EACH x IN list DO" },
        { id: "if_x_eq_key", text: "    IF x = key THEN" },
        { id: "set_found_true", text: "        SET found ← TRUE" },
        { id: "end_if_inner", text: "    END IF" },
        { id: "end_for", text: "END FOR" },
        { id: "if_found_true", text: "IF found = TRUE THEN" },
        { id: "print_found", text: "    PRINT \"Found\"" },
        { id: "else_not_found", text: "ELSE" },
        { id: "print_not_found", text: "    PRINT \"Not found\"" },
        { id: "end_if_outer", text: "END IF" },
        // distractors
        { id: "set_found_true_wrong", text: "SET found ← TRUE" },
        { id: "print_x", text: "PRINT x" }
      ],
      solution: [
        "set_found_false",
        "for_each_x",
        "if_x_eq_key",
        "set_found_true",
        "end_if_inner",
        "end_for",
        "if_found_true",
        "print_found",
        "else_not_found",
        "print_not_found",
        "end_if_outer"
      ]
    }
  };

  const puzzleSelect = document.getElementById("puzzleSelect");
  const puzzleDescDiv = document.getElementById("puzzleDesc");
  const availableBlocksDiv = document.getElementById("availableBlocks");
  const yourLogicArea = document.getElementById("yourLogicArea");
  const undoBtn = document.getElementById("undoBtn");
  const clearBtn = document.getElementById("clearBtn");
  const checkBtn = document.getElementById("checkBtn");
  const scoreLine = document.getElementById("scoreLine");
  const feedbackText = document.getElementById("feedbackText");

  let currentPuzzleId = puzzleSelect.value;
  let chosenBlocks = []; // array of block IDs in order

  function renderPuzzle() {
    const p = puzzles[currentPuzzleId];
    if (!p) return;

    // description
    puzzleDescDiv.innerHTML = `<strong>${p.title}</strong><br>${p.description}`;

    // available blocks (RANDOMIZED ORDER)
    availableBlocksDiv.innerHTML = "";
    const blocksShuffled = [...p.blocks];
    for (let i = blocksShuffled.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [blocksShuffled[i], blocksShuffled[j]] = [blocksShuffled[j], blocksShuffled[i]];
    }
    blocksShuffled.forEach(block => {
      const div = document.createElement("div");
      div.className = "code-block";
      div.textContent = block.text;
      div.dataset.blockId = block.id;
      div.addEventListener("click", () => onBlockClick(block.id));
      availableBlocksDiv.appendChild(div);
    });

    // reset chosen
    chosenBlocks = [];
    renderChosenBlocks();
    resetFeedback();
  }

  function onBlockClick(blockId) {
    const p = puzzles[currentPuzzleId];
    if (!p) return;

    const blockEls = availableBlocksDiv.querySelectorAll(".code-block");
    const el = [...blockEls].find(e => e.dataset.blockId === blockId);
    if (!el || el.classList.contains("disabled")) return;

    chosenBlocks.push(blockId);
    el.classList.add("disabled");

    renderChosenBlocks();
    resetFeedback();
  }

  function renderChosenBlocks() {
    yourLogicArea.innerHTML = "";

    if (chosenBlocks.length === 0) {
      yourLogicArea.innerHTML = `<span style="font-size:11px;color:#64748b;">
        Your chosen blocks will appear here in order:<br>
        <em>Step 1, Step 2, Step 3, ...</em>
      </span>`;
      return;
    }

    const p = puzzles[currentPuzzleId];
    const blockMap = {};
    p.blocks.forEach(b => { blockMap[b.id] = b.text; });

    chosenBlocks.forEach((id, index) => {
      const div = document.createElement("div");
      div.className = "logic-block";
      const idxSpan = document.createElement("span");
      idxSpan.className = "logic-index";
      idxSpan.textContent = (index + 1) + ".";
      const textSpan = document.createElement("span");
      textSpan.textContent = blockMap[id] || id;
      div.appendChild(idxSpan);
      div.appendChild(textSpan);
      yourLogicArea.appendChild(div);
    });
  }

  function resetFeedback() {
    scoreLine.textContent = "Score: —";
    scoreLine.className = "";
    feedbackText.textContent = "Build a program above and press \"Check Logic\" to see how close you are.";
  }

  function undoLast() {
    if (chosenBlocks.length === 0) return;
    const lastId = chosenBlocks.pop();

    const blockEls = availableBlocksDiv.querySelectorAll(".code-block");
    blockEls.forEach(el => {
      if (el.dataset.blockId === lastId) {
        el.classList.remove("disabled");
      }
    });

    renderChosenBlocks();
    resetFeedback();
  }

  function clearAll() {
    chosenBlocks = [];
    const blockEls = availableBlocksDiv.querySelectorAll(".code-block");
    blockEls.forEach(el => el.classList.remove("disabled"));
    renderChosenBlocks();
    resetFeedback();
  }

  function checkLogic() {
    const p = puzzles[currentPuzzleId];
    const sol = p.solution;
    const attempt = chosenBlocks;

    if (attempt.length === 0) {
      scoreLine.textContent = "Score: 0";
      scoreLine.className = "bad";
      feedbackText.textContent = "You have not added any blocks yet. Try building a sequence first.";
      return;
    }

    let correctPrefix = 0;
    const minLen = Math.min(sol.length, attempt.length);
    for (let i = 0; i < minLen; i++) {
      if (sol[i] === attempt[i]) correctPrefix++;
      else break;
    }

    const exact = (attempt.length === sol.length && correctPrefix === sol.length);

    let score;
    if (exact) {
      score = 100;
    } else {
      const prefixScore = (correctPrefix / sol.length) * 80;
      const lengthPenalty = Math.max(0, attempt.length - sol.length) * 5;
      score = Math.max(0, Math.round(prefixScore - lengthPenalty));
    }

    scoreLine.textContent = "Score: " + score;
    if (score >= 80) {
      scoreLine.className = "good";
    } else {
      scoreLine.className = "bad";
    }

    if (exact) {
      feedbackText.innerHTML =
        `✔ <strong>Perfect!</strong> Your sequence matches one correct solution for this puzzle.`;
    } else {
      let msg = "";
      if (correctPrefix === 0) {
        msg += "The first block does not match the expected start of the logic.<br>";
      } else {
        msg += `The first <strong>${correctPrefix}</strong> block(s) are in the correct order, `;
        msg += `but something goes wrong after step ${correctPrefix}.<br>`;
      }
      if (attempt.length < sol.length) {
        msg += `You may be missing <strong>${sol.length - attempt.length}</strong> block(s).`;
      } else if (attempt.length > sol.length) {
        msg += `You may have extra or misplaced block(s) near the end.`;
      } else {
        msg += `Check your middle steps carefully. One of them is not what the logic expects.`;
      }
      feedbackText.innerHTML = msg;
    }
  }

  puzzleSelect.addEventListener("change", () => {
    currentPuzzleId = puzzleSelect.value;
    renderPuzzle();
  });

  undoBtn.addEventListener("click", undoLast);
  clearBtn.addEventListener("click", clearAll);
  checkBtn.addEventListener("click", checkLogic);

  // initial render
  renderPuzzle();
</script>
</body>
</html>
